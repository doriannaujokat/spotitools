<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#1DB954">
    <link rel="stylesheet" href="/main.css">
    <script src="/auth.mjs" type="module"></script>
    <script>
        window.addEventListener('load', async () => {
            let redirect = (await import('/auth.mjs')).authenticate;
            if (localStorage.getItem('token')) {
                const token = localStorage.getItem('token');
                const { Spotify } = await import('/spotify.js');
                const spotify = new Spotify(token);
                try {
                    await spotify.ApiFetch('/me','GET');
                    const redirect = localStorage.getItem('redirect_uri');
                    localStorage.removeItem('redirect_uri');
                    window.location.replace(redirect ?? '/');
                    return;
                } catch (ex) {
                    localStorage.removeItem('token');
                }
            }
            document.getElementById('login-button').addEventListener('click', () => redirect('/', true));
        });
    </script>
</head>
<body>
    <div id="login">
        <button class="button" id="login-button">
            <div>Login with</div>
        </button>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 150" class="spotify-logo">
            <path d="m488.46 62.758h-2.0904v2.6658h2.0904c1.0434 0 1.6665-.51052 1.6665-1.3336 0-.86716-.62306-1.3322-1.6665-1.3322zm1.3554 3.8029 2.271 3.1801h-1.915l-2.0445-2.9168h-1.7572v2.9168h-1.603v-8.4289h3.7586c1.9573 0 3.2457 1.0022 3.2457 2.6886 0 1.3815-.79842 2.2259-1.9555 2.5602zm-1.7802-8.053c-4.1129 0-7.2255 3.2686-7.2255 7.2729 0 4.0016 3.0906 7.2271 7.1832 7.2271 4.112 0 7.2273-3.2669 7.2273-7.2729 0-4.0017-3.0924-7.2271-7.185-7.2271zm-.0423 15.303c-4.5156 0-8.0292-3.6267-8.0292-8.0303 0-4.4043 3.5594-8.0722 8.0715-8.0722 4.5148 0 8.0293 3.6264 8.0293 8.0264 0 4.4043-3.5568 8.076-8.0716 8.076m-99.955-38.67c-4.5192 0-8.1879 3.6599-8.1879 8.1791 0 4.5227 3.6687 8.1861 8.1879 8.1861 4.5183 0 8.1826-3.6635 8.1826-8.1861 0-4.5192-3.6643-8.1791-8.1826-8.1791m5.6472 22.665h-11.41c-.4609 0-.83545.37542-.83545.83632v49.778c0 .46099.37455.83553.83545.83553h11.41c.46002 0 .83545-.37454.83545-.83553v-49.778c0-.4609-.37543-.83632-.83545-.83632m25.359.05024v-1.5766c0-4.6381 1.7784-6.7065 5.767-6.7065 2.3785 0 4.2891.47236 6.4289 1.1862.26349.08279.53845.0414.75259-.11628.22032-.15776.34457-.41067.34457-.67858v-9.6147c0-.36749-.23618-.69267-.58956-.80019-2.2604-.6724-5.1528-1.3633-9.4833-1.3633-10.539 0-16.109 5.9345-16.109 17.156v2.4147h-5.4815c-.46003 0-.83721.37455-.83721.83545v9.8559c0 .46063.37718.83579.83721.83579h5.4815v39.137c0 .46099.3719.83553.83192.83553h11.409c.46089 0 .83633-.37454.83633-.83553v-39.137h10.653l16.318 39.127c-1.8524 4.111-3.674 4.929-6.161 4.929-2.0102 0-4.127-.60041-6.2914-1.7846-.20356-.11227-.44416-.13049-.66447-.0627-.21767.0774-.40098.23891-.49351.4513l-3.867 8.4839c-.1842.40072-.0273.87167.35867 1.0796 4.0371 2.1863 7.682 3.1196 12.185 3.1196 8.4249 0 13.082-3.9251 17.187-14.483l19.794-51.149c.0987-.25732.0697-.54726-.0881-.77639-.15688-.22561-.40979-.3622-.68652-.3622h-11.878c-.35515 0-.67417.22561-.79051.55961l-12.168 34.756-13.327-34.778c-.12163-.32344-.4327-.5367-.77905-.5367h-19.491m-43.744-.05024h-12.555v-12.837c0-.46092-.37188-.83545-.8328-.83545h-11.408c-.46179 0-.83721.37454-.83721.83545v12.837h-5.4859c-.46002 0-.83103.37542-.83103.83632v9.8056c0 .46064.37101.8358.83103.8358h5.4859v25.373c0 10.254 5.1034 15.452 15.168 15.452 4.0926 0 7.4882-.84513 10.688-2.6596.25999-.14531.42214-.42556.42214-.72361v-9.3377c0-.28853-.1507-.55978-.39656-.71127-.24853-.15589-.55785-.16382-.81253-.03778-2.1979 1.1056-4.3226 1.6162-6.6977 1.6162-3.6599 0-5.2938-1.6613-5.2938-5.3864v-23.585h12.555c.4609 0 .83193-.37517.83193-.8358v-9.8056c0-.4609-.37103-.83632-.83193-.83632m-60.165 41.01c-8.1791 0-14.345-6.5717-14.345-15.285 0-8.7497 5.953-15.099 14.157-15.099 8.2319 0 14.44 6.5713 14.44 15.29 0 8.7487-5.9935 15.094-14.251 15.094zm0-42.053c-15.377 0-27.424 11.841-27.424 26.96 0 14.954 11.964 26.671 27.236 26.671 15.432 0 27.516-11.801 27.516-26.862 0-15.01-12.001-26.768-27.327-26.768m-44.249 26.768c0 8.9477-5.5114 15.191-13.403 15.191-7.8019 0-13.687-6.5272-13.687-15.191 0-8.6626 5.8851-15.191 13.687-15.191 7.7649 0 13.403 6.3872 13.403 15.191zm-10.762-26.768c-6.4262 0-11.697 2.531-16.044 7.7173v-5.8375c0-.4609-.37366-.83632-.83457-.83632h-11.409c-.4609 0-.83368.37542-.83368.83632v64.863c0 .46091.37278.83615.83368.83615h11.409c.46091 0 .83457-.37524.83457-.83615v-20.474c4.3473 4.8786 9.619 7.2615 16.044 7.2615 11.94 0 24.028-9.1917 24.028-26.762 0-17.574-12.088-26.768-24.028-26.768m-55.397 12.567c-12.742-3.0387-15.012-5.1716-15.012-9.6517 0-4.2345 3.9869-7.0828 9.9143-7.0828 5.7459 0 11.442 2.1635 17.417 6.6174.18066.13485.40714.1886.63011.15335.22296-.03349.41948-.1551.5508-.34016l6.2218-8.7704c.25556-.36044.18594-.85924-.15863-1.1351-7.1092-5.7045-15.115-8.4778-24.472-8.4778-13.758 0-23.369 8.2557-23.369 20.07 0 12.669 8.2901 17.154 22.616 20.616 12.193 2.8087 14.251 5.1613 14.251 9.3683 0 4.6608-4.1614 7.5586-10.858 7.5586-7.437 0-13.505-2.5054-20.291-8.3827-.16833-.14455-.39922-.21134-.61249-.19926-.22385.01849-.42919.12258-.57194.29424l-6.9761 8.3025c-.29258.34468-.25556.85924.082 1.157 7.8971 7.0495 17.608 10.774 28.088 10.774 14.826 0 24.406-8.1014 24.406-20.639 0-10.596-6.331-16.456-21.856-20.232m-83.33-2.7051c-23.789-14.127-63.028-15.426-85.738-8.5339-3.647 1.106-7.5032-.95266-8.6082-4.5994-1.105-3.6485.95151-7.5022 4.6008-8.6109 26.069-7.9138 69.405-6.3848 96.791 9.872 3.281 1.9467 4.357 6.183 2.412 9.4586-1.9458 3.2796-6.1856 4.3609-9.4578 2.4135zm-.77904 20.925c-1.6682 2.7085-5.2092 3.5571-7.9138 1.8951-19.833-12.191-50.076-15.723-73.54-8.6007-3.0428.91953-6.2567-.79587-7.1806-3.8332-.91714-3.0428.79931-6.2509 3.8366-7.1762 26.804-8.1333 60.125-4.1939 82.904 9.8048 2.7046 1.6655 3.5559 5.2085 1.893 7.9101zm-9.0304 20.096c-1.3254 2.1743-4.1578 2.8562-6.324 1.5309-17.331-10.592-39.144-12.985-64.833-7.1163-2.4758.56771-4.9427-.9842-5.5076-3.459-.56692-2.4754.97839-4.942 3.4597-5.5069 28.112-6.4267 52.227-3.6607 71.679 8.2258 2.1688 1.3243 2.8518 4.1578 1.5255 6.3255zm-33.845-106.45c-40.758 0-73.8 33.041-73.8 73.799 0 40.762 33.042 73.802 73.8 73.802 40.76 0 73.8-33.04 73.8-73.802 0-40.758-33.041-73.799-73.8-73.799" />
        </svg>
    </div>
    <div id="github-link">
        <a href="https://github.com/doriannaujokat/spotitools" target="_blank" title="View source code">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
                <path d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z" />
            </svg>
        </a>
    </div>
</body>
</html>